#!/usr/bin/env bash

# Update cache versions before commit and stage changes so they are included
# in the user's commit. This avoids requiring an extra commit and prevents
# an endless loop where the hook modifies files but those changes are not
# staged.

set -e

echo "Running update-cache-versions..."
node ./scripts/update-cache-versions.js || {
  echo "update-cache-versions failed" >&2
  exit 1
}

# Stage any files the script may have modified
git add service-worker.js script.js package.json || true

exit 0
